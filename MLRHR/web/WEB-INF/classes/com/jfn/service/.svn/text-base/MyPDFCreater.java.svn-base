package com.jfn.service;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.zip.ZipEntry;
import java.util.zip.ZipOutputStream;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

import com.itextpdf.text.BaseColor;
import com.itextpdf.text.Chunk;
import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Element;
import com.itextpdf.text.Font;
import com.itextpdf.text.Image;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.Rectangle;
import com.itextpdf.text.pdf.AcroFields;
import com.itextpdf.text.pdf.BaseFont;
import com.itextpdf.text.pdf.PdfImportedPage;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfReader;
import com.itextpdf.text.pdf.PdfStamper;
import com.itextpdf.text.pdf.PdfWriter;
import com.jfn.entity.Attachfile;
import com.jfn.entity.Body;
import com.jfn.entity.User;
import com.jfn.entity.UserAward;
import com.jfn.entity.UserBaseInfor;
import com.jfn.entity.UserBusiness;
import com.jfn.entity.UserChengguo;
import com.jfn.entity.UserExam;
import com.jfn.entity.UserPeixun;
import com.jfn.entity.UserProject;
import com.jfn.entity.UserReport;
import com.jfn.entity.UserSkill;
import com.jfn.entity.UserSkill_2;
import com.jfn.entity.UserWork;
import com.jfn.entity.UserZhuanli;
import com.jfn.entity.ZhichengApply;
import com.jfn.entity.ZhichengDoc08;

@Repository
public class MyPDFCreater {
	private static final Logger log = LoggerFactory.getLogger(MyPDFCreater.class);
	public BaseFont bfChi;
	public Font f10;
	public Font f12;
	public Font fb12;
	public Font f14;
	public Font f16;
	public Font fb16;
	public Font f17;
	public Font fb17;
	public Font f18;
	public Font fb18;
	public Font f20;
	public Font fb20;
	public Font ftemp;

	private String m_strTemplate;
	@Autowired
	private UserService userservice;
	@Autowired
	private UserBaseInforService userbaseinforservice;
	@Autowired
	private UserChengguoService userchengguoservice;
	@Autowired
	private UserExamService userexamservice;
	@Autowired
	private UserPeixunService userpeixunservice;
	@Autowired
	private UserProjectService userprojectservice;
	@Autowired
	private UserSkillService userskillservice;
	@Autowired
	private UserSkill_2Service userskill_2service;
	@Autowired
	private UserStudyService userstudyservice;
	@Autowired
	private UserWorkService userworkservice;
	@Autowired
	private UserReportService userreportservice;
	@Autowired
	private UserZhuanliService userzhuanliservice;
	@Autowired
	private UserAwardService userawardservice;
	@Autowired
	private AccountManager accountManager;
	@Autowired
	private BodyService bodyservice;
	@Autowired
	private ZhichengApplyService zhichengapplyservice;
	@Autowired
	private FileService fileservice;
	@Autowired
	private UserBusinessService userbusinessservice;
	@Autowired
	private ZhichengDoc08Service zhichengdoc08service;
	@Autowired
	private CalendarService calendarservice;

	public String exportPath;
	public String templetPath = getTempletFilePath();

	/*
	 * firstTime address name year country address2 membershipNum Payer name
	 * Dues for Date of Invoice USD USD_2 USD_3 TOTAL country2
	 */
	public boolean CreatePDF(String fileName, Map<String, String> mapValues) {
		try {
			PdfReader reader = new PdfReader(m_strTemplate);

			/* 将要生成的目标PDF文件名称 */
			PdfStamper stamp = new PdfStamper(reader, new FileOutputStream(fileName));

			/* 取出报表模板中的所有字段 */
			AcroFields form = stamp.getAcroFields();
			java.util.HashMap map = form.getFields();
			for (Iterator it = map.keySet().iterator(); it.hasNext();) {
				String strFieldName = it.next().toString();
				Object obj = mapValues.get(strFieldName);
				if (obj != null) {
					form.setField(strFieldName, (String) obj);
				}
			}
			stamp.setFormFlattening(true);
			/* 必须要调用这个，否则文档不会生成的 */
			stamp.close();
			return true;
		} catch (Exception e) {
			return false;
		}

	}

	// 获取模板pdf文件路径
	public String getTempletFilePath() {
		String path = String.valueOf(this.getClass().getClassLoader().getResource("/").getPath());
		path = path.substring(1, path.lastIndexOf("WEB-INF"));
		path = path.replaceAll("%20", " ");
		path = path + "ExportFile/";
		return path;
	}

	// 存放最终生成pdf文件路径
	public String getExportFilePath() {
		String path = String.valueOf(this.getClass().getClassLoader().getResource("/").getPath());
		path = path.substring(1, path.lastIndexOf("MLRHR"));
		path = path.replaceAll("%20", " ");
		path = path + "exportFile/";
		return path;
	}

	/**
	 * 根据pdf模板填充相应的值： 1，如果是根据excel填充的话，在用Acrobat生成PDF模板前，
	 * Excel单元格格式最好设置成文本，否则pdf填充值时可能中文无法显示
	 */
	public String fromPDFTempletToPdfWithValue(String zhichengApply_id) throws Exception {

		ZhichengApply zhichengapply = zhichengapplyservice.getById(zhichengApply_id);

		createDocinit(zhichengapply);
		createDoc01(zhichengapply);
		createDoc02(zhichengapply);
		createDoc03(zhichengapply);
		createDoc04(zhichengapply);
		createDoc05(zhichengapply);
		createDoc06(zhichengapply);
		createDoc07(zhichengapply);
		createDoc08(zhichengapply);
		createDoc09(zhichengapply);

		String fileNameString = createZip(zhichengapply);
		zhichengapply.setFile_name(fileNameString);
		zhichengapplyservice.Update(zhichengapply);

		return fileNameString;
	}

	public String fromPDFTempletToPdfWithValue_temp(String user_id) throws Exception {

		ZhichengApply zhichengapply = new ZhichengApply();
		zhichengapply.setUser_id(Integer.parseInt(user_id));

		createDocinit(zhichengapply);
		createDoc01(zhichengapply);
		createDoc02(zhichengapply);
		createDoc03(zhichengapply);
		createDoc04(zhichengapply);
		createDoc05(zhichengapply);
		createDoc06(zhichengapply);
		createDoc07(zhichengapply);
		createDoc08(zhichengapply);
		createDoc09(zhichengapply);

		String fileNameString = createZip(zhichengapply);
		zhichengapply.setFile_name(fileNameString);
		zhichengapplyservice.Update(zhichengapply);

		return fileNameString;
	}

	private void createDocinit(ZhichengApply zhichengapply) throws DocumentException, IOException {
		String apply_date = zhichengapply.getApply_date();
		String Year = "";
		if (apply_date != null && apply_date != "") {
			Year = apply_date.substring(0, 4);
		} else {
			Calendar cal = Calendar.getInstance();
			Year = cal.get(Calendar.YEAR) + "";
		}
		exportPath = getExportFilePath();
		// 如果没有输出路径，创建
		File dir = new File(exportPath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}
		exportPath = exportPath + "\\" + Year + "\\";
		// 如果没有输出路径，创建
		dir = new File(exportPath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}
		exportPath = exportPath + "\\user\\";
		// 如果没有输出路径，创建
		dir = new File(exportPath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}
		exportPath = exportPath + zhichengapply.getUser_id().toString() + "\\";
		// 如果没有输出路径，创建
		dir = new File(exportPath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}
		// 设置字体格式
		// BaseFont bfChi = BaseFont.createFont("STSong-Light",
		// "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
		bfChi = BaseFont.createFont("C:/WINDOWS/Fonts/simfang.ttf", BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);
		f10 = new Font(bfChi, 10, Font.NORMAL);
		f12 = new Font(bfChi, 12, Font.NORMAL);
		fb12 = new Font(bfChi, 12, Font.BOLD);
		f14 = new Font(bfChi, 14, Font.NORMAL);
		f16 = new Font(bfChi, 16, Font.NORMAL);
		fb16 = new Font(bfChi, 16, Font.BOLD);
		f17 = new Font(bfChi, 17, Font.NORMAL);
		fb17 = new Font(bfChi, 17, Font.BOLD);
		f18 = new Font(bfChi, 18, Font.NORMAL);
		fb18 = new Font(bfChi, 18, Font.BOLD);
		f20 = new Font(bfChi, 20, Font.NORMAL);
		fb20 = new Font(bfChi, 20, Font.BOLD);
	}

	private String createZip(ZhichengApply zhichengapply) throws Exception {
		String apply_date = zhichengapply.getApply_date();
		String Year = "";
		if (apply_date != null && apply_date != "") {
			Year = apply_date.substring(0, 4);
		} else {
			Calendar cal = Calendar.getInstance();
			Year = cal.get(Calendar.YEAR) + "";
		}
		SimpleDateFormat ft = null;
		Date date = null;
		Calendar cl = Calendar.getInstance();
		cl.setTime(new java.util.Date());
		date = cl.getTime();
		ft = new SimpleDateFormat("yyyyMMddHHmmss");
		String dateTime = ft.format(date);

		File dir = new File(exportPath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}

		// 获取所有pdf文件
		List<File> fileList = new ArrayList<File>();
		if (dir.isDirectory()) {
			File files[] = dir.listFiles();
			for (int i = 0; i < files.length; i++) {
				File currFile = files[i];
				if (currFile.isFile()) {
					String filename = currFile.getName();
					String str = filename.substring(filename.lastIndexOf(".") + 1);
					if (str.equals("pdf")) {
						// System.out.println(currFile.getPath());
						File temp = new File(currFile.getPath());
						fileList.add(temp);
					}
				}
			}
		}

		byte[] buffer = new byte[1024];
		// 生成的ZIP文件名为Demo.zip
		String strZipName = exportPath + "\\" + dateTime + ".zip";
		ZipOutputStream out = new ZipOutputStream(new FileOutputStream(strZipName));
		// 需要同时下载的两个文件result.txt ，source.txt

		for (int i = 0; i < fileList.size(); i++) {
			FileInputStream fis = new FileInputStream(fileList.get(i));
			out.putNextEntry(new ZipEntry(fileList.get(i).getName()));
			int len;
			// 读入需要下载的文件的内容，打包到zip文件
			while ((len = fis.read(buffer)) > 0) {
				out.write(buffer, 0, len);
			}
			out.closeEntry();
			fis.close();
		}
		out.close();
		// System.out.println("生成Demo.zip成功");
		return Year + "/user/" + zhichengapply.getUser_id().toString() + "/" + dateTime + ".zip";
	}

	private void createDoc01(ZhichengApply zhichengapply) {
		String fileName = templetPath + "\\doc01.pdf"; //
		try {
			PdfReader reader = new PdfReader(fileName);
			ByteArrayOutputStream bos = new ByteArrayOutputStream();
			PdfStamper stamp = new PdfStamper(reader, bos);

			/**
			 * 使用中文字体 如果是利用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体就行了
			 */
			AcroFields form = stamp.getAcroFields();

			User user = userservice.getById(zhichengapply.getUser_id().toString());
			Body body = bodyservice.getById(user.getBody_id());
			// （第一页）
			form.setField("body_name", body.getName());
			form.setField("user_name", user.getName());

			stamp.setFormFlattening(true);
			reader.close();
			stamp.close();
			String tempPath = exportPath + "\\1 申报材料审核确认表.pdf";
			FileOutputStream fos = new FileOutputStream(tempPath);
			fos.write(bos.toByteArray());
			bos.close();
			fos.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();
		}
	}

	private void createDoc02(ZhichengApply zhichengapply) {
		String fileName = templetPath + "\\doc02.pdf"; //
		try {
			User user = userservice.getById(zhichengapply.getUser_id().toString());
			List<Attachfile> list = fileservice.getFilesByUploaderAndType(user.getId(), 1);
			int fileTypeNum[] = new int[8];
			for (int i = 0; i < 8; i++)
				fileTypeNum[i] = 0;
			if (list != null && list.size() > 0) {
				for (int i = 0; i < list.size(); i++) {
					Attachfile attachfile = (Attachfile) list.get(i);
					switch (attachfile.getFile_type_num()) {
					case 1:
						fileTypeNum[0]++;
						break;
					case 2:
						fileTypeNum[1]++;
						break;
					case 3:
						fileTypeNum[2]++;
						break;
					case 4:
						fileTypeNum[3]++;
						break;
					case 5:
						fileTypeNum[4]++;
						break;
					case 6:
						fileTypeNum[5]++;
						break;
					case 7:
						fileTypeNum[6]++;
						break;
					case 8:
						fileTypeNum[7]++;
						break;
					default:
						break;
					}
				}
			}

			PdfReader reader = new PdfReader(fileName);
			ByteArrayOutputStream bos = new ByteArrayOutputStream();
			PdfStamper stamp = new PdfStamper(reader, bos);
			/**
			 * 使用中文字体 如果是利用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体就行了
			 */
			AcroFields form = stamp.getAcroFields();
			// （第一页）
			form.setField("user_name", user.getName());
			form.setField("series_name", zhichengapply.getApply_type());
			form.setField("apply_name", zhichengapply.getApply_name());
			form.setField("ft01", fileTypeNum[0] + "");
			form.setField("ft02", fileTypeNum[1] + "");
			form.setField("ft03", fileTypeNum[2] + "");
			form.setField("ft04", fileTypeNum[3] + "");
			form.setField("ft05", fileTypeNum[4] + "");
			form.setField("ft06", fileTypeNum[5] + "");
			form.setField("ft07", fileTypeNum[6] + "");
			form.setField("ft08", fileTypeNum[7] + "");

			stamp.setFormFlattening(true);
			reader.close();
			stamp.close();
			String tempPath = exportPath + "\\8 证明证书材料封面.pdf";
			FileOutputStream fos = new FileOutputStream(tempPath);
			fos.write(bos.toByteArray());
			bos.close();
			fos.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();
		}
	}

	private void createDoc03(ZhichengApply zhichengapply) {
		String fileName = templetPath + "\\doc03.pdf"; //
		try {
			User user = userservice.getById(zhichengapply.getUser_id().toString());
			List<Attachfile> list = fileservice.getFilesByUploaderAndType(user.getId(), 2);
			int fileTypeNum[] = new int[5];
			for (int i = 0; i < 5; i++)
				fileTypeNum[i] = 0;
			if (list != null && list.size() > 0) {
				for (int i = 0; i < list.size(); i++) {
					Attachfile attachfile = (Attachfile) list.get(i);
					switch (attachfile.getFile_type_num()) {
					case 1:
						fileTypeNum[0]++;
						break;
					case 2:
						fileTypeNum[1]++;
						break;
					case 3:
						fileTypeNum[2]++;
						break;
					case 4:
						fileTypeNum[3]++;
						break;
					case 5:
						fileTypeNum[4]++;
						break;
					default:
						break;
					}
				}
			}

			PdfReader reader = new PdfReader(fileName);
			ByteArrayOutputStream bos = new ByteArrayOutputStream();
			PdfStamper stamp = new PdfStamper(reader, bos);
			/**
			 * 使用中文字体 如果是利用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体就行了
			 */
			AcroFields form = stamp.getAcroFields();
			// （第一页）
			form.setField("user_name", user.getName());
			form.setField("series_name", zhichengapply.getApply_type());
			form.setField("apply_name", zhichengapply.getApply_name());
			form.setField("ftPDF01", fileTypeNum[0] + "");
			form.setField("ftPDF02", fileTypeNum[1] + "");
			form.setField("ftPDF03", fileTypeNum[2] + "");
			form.setField("ftPDF04", fileTypeNum[3] + "");

			stamp.setFormFlattening(true);
			reader.close();
			stamp.close();
			String tempPath = exportPath + "\\9 业绩成果材料封面.pdf";
			FileOutputStream fos = new FileOutputStream(tempPath);
			fos.write(bos.toByteArray());
			bos.close();
			fos.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();
		}
	}

	private void createDoc04(ZhichengApply zhichengapply) {
		String fileName = templetPath + "\\doc04.pdf"; //
		try {
			PdfReader reader = new PdfReader(fileName);
			ByteArrayOutputStream bos = new ByteArrayOutputStream();
			PdfStamper stamp = new PdfStamper(reader, bos);

			/**
			 * 使用中文字体 如果是利用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体就行了
			 */
			AcroFields form = stamp.getAcroFields();

			User user = userservice.getById(zhichengapply.getUser_id().toString());
			Body body = bodyservice.getById(user.getBody_id());
			UserBusiness userbusiness = userbusinessservice.getByUserId(user.getId());

			// （第一页）
			form.setField("body_name", body.getName());
			form.setField("user_name", user.getName());

			stamp.setFormFlattening(true);
			reader.close();
			stamp.close();
			String tempPath = templetPath + "\\temp_04.pdf";
			FileOutputStream fos = new FileOutputStream(tempPath);
			fos.write(bos.toByteArray());
			bos.close();
			fos.close();
			// 重新读取PDF到document，继续添加后面页面
			Document document = new Document();
			PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(exportPath + "\\" + "2 业务自传" + ".pdf"));

			document.open();
			PdfReader reader3 = new PdfReader(tempPath);
			int n = reader.getNumberOfPages();
			PdfImportedPage page;
			for (int i = 1; i <= n; i++) {
				page = writer.getImportedPage(reader3, i);
				Image image = Image.getInstance(page);
				image.setAbsolutePosition(0, 0);
				document.add(image);
				document.newPage();
			}

			Paragraph p = new Paragraph();

			// 第二页
			document.add(new Paragraph(userbusiness.getAutobiography(), f14));

			document.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();
		}
	}

	public void createDoc05(ZhichengApply zhichengapply) {

		// String apply_date = zhichengapply.getApply_date();
		// Year = apply_date.substring(0, 4);
		// String Month = apply_date.substring(5, 7);
		// String Day = apply_date.substring(8, 10);

		Calendar cal = Calendar.getInstance();
		int Year = cal.get(Calendar.YEAR);
		int Month = cal.get(Calendar.MONTH) + 1;
		int Day = cal.get(Calendar.DATE);

		SimpleDateFormat ft = null;
		Date date = null;
		Calendar cl = Calendar.getInstance();
		cl.setTime(new java.util.Date());
		date = cl.getTime();
		ft = new SimpleDateFormat("yyyyMMddHHmmss");
		String dateTime = ft.format(date);
		// System.out.println("时间：" + dateTime);

		String fileName = templetPath + "\\doc05_1.pdf"; //
		try {
			PdfReader reader = new PdfReader(fileName);
			ByteArrayOutputStream bos = new ByteArrayOutputStream();
			PdfStamper stamp = new PdfStamper(reader, bos);

			/**
			 * 使用中文字体 如果是利用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体就行了
			 */
			AcroFields form = stamp.getAcroFields();

			User user = userservice.getById(zhichengapply.getUser_id().toString());
			UserBaseInfor userbaseinfor = userbaseinforservice.getByUserId(zhichengapply.getUser_id().toString());
			Body body = bodyservice.getById(user.getBody_id());
			// 封皮（第一页）
			form.setField("body_name", body.getName());
			form.setField("user_name", user.getName());
			form.setField("apply_name", zhichengapply.getApply_name());
			form.setField("renzhizige", userbaseinfor.getRenzhizige());
			form.setField("user_former_name", userbaseinfor.getFormer_name());
			form.setField("Year", Year + "");
			form.setField("Month", Month + "");
			form.setField("Day", Day + "");
			// 第二页
			form.setField("user_gender", userbaseinfor.getGender());
			form.setField("user_minzu", userbaseinfor.getMinzu());
			form.setField("user_birthday", userbaseinfor.getBirthday());
			form.setField("user_chushengdi", userbaseinfor.getChushengdi());
			form.setField("user_canjiashijian", userbaseinfor.getCanjiashijian());
			form.setField("user_health", userbaseinfor.getHealth());

			form.setField("current_zhicheng", userbaseinfor.getCurrent_zhicheng());
			form.setField("current_zhicheng_date", userbaseinfor.getCurrent_zhicheng_date());
			form.setField("user_congshizhuanye", userbaseinfor.getCongshizhuanye());
			if (userbaseinfor.getShenpishijian() == null && userbaseinfor.getShenpidanwei() == "") {
				form.setField("user_renzhizige", userbaseinfor.getRenzhizige());
			} else {
				String tempString = userbaseinfor.getShenpishijian() == null ? "" : userbaseinfor.getShenpishijian();
				form.setField("user_renzhizige", userbaseinfor.getRenzhizige() + "(" + tempString + " " + userbaseinfor.getShenpidanwei() + ")");
			}
			String tempsString2 = userbaseinfor.getXingzhengshijian() == null ? "" : userbaseinfor.getXingzhengshijian();
			form.setField("user_xingzhengzhiwu", userbaseinfor.getXingzhengzhiwu() + " " + tempsString2);
			form.setField("user_zhengzhi", userbaseinfor.getZhengzhi());
			form.setField("user_minzhudangpai", userbaseinfor.getMinzhudangpai());
			form.setField("user_shehuijianzhi", userbaseinfor.getShehuijianzhi());
			form.setField("user_yuyan", userbaseinfor.getYuyan());
			form.setField("user_gongzi", userbaseinfor.getGongzi());

			UserPeixun userpeixun = userpeixunservice.getByUserId(zhichengapply.getUser_id().toString());

			form.setField("user_study_end_date", userpeixun.getEnd_date());
			form.setField("user_study_xuexiao", userpeixun.getPlace());
			form.setField("user_study_zhuanye", userpeixun.getContent());
			form.setField("user_study_xuezhi", userpeixun.getXuezhi());
			form.setField("user_study_xuewei", userpeixun.getXuewei());

			// 先将第一页和第二页导出生成临时pdf
			stamp.setFormFlattening(true);
			reader.close();
			stamp.close();
			String tempPath = templetPath + "\\temp_05.pdf";
			FileOutputStream fos = new FileOutputStream(tempPath);
			fos.write(bos.toByteArray());
			bos.close();
			fos.close();
			// 重新读取PDF到document，继续添加后面页面
			Document document = new Document();
			PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(exportPath + "\\" + "3 专业技术职务任职资格评审表" + ".pdf"));
			// 设置页码
			Rectangle rect = new Rectangle(36, 54, 559, 788);
			rect.setBorderColor(BaseColor.BLACK);
			writer.setBoxSize("art", rect);
			HeaderFooter header = new HeaderFooter();
			writer.setPageEvent(header);

			document.open();
			PdfReader reader3 = new PdfReader(tempPath);
			int n = reader.getNumberOfPages();
			PdfImportedPage page;
			for (int i = 1; i <= n; i++) {
				page = writer.getImportedPage(reader3, i);
				Image image = Image.getInstance(page);
				image.setAbsolutePosition(0, 0);
				document.add(image);
				document.newPage();
			}
			Paragraph p = new Paragraph();

			// 第三页 添加学 习 培 训 经 历
			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("学 习 培 训 经 历"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(10);
			document.add(p);
			// 第三页 添加（包括参加专业学习、培训、国内外进修等）
			p = new Paragraph();
			p.setFont(fb17);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("（包括参加专业学习、培训、国内外进修等）"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(10);
			document.add(p);

			// 添加一个表格
			float[] widths = { 0.3f, 0.25f, 0.30f, 0.15f };
			PdfPTable table = new PdfPTable(widths);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);
			PdfPCell cell;
			cell = new PdfPCell(new Paragraph("起 止 时 间", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setMinimumHeight(30);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("专业或主要内容", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("学习地点", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("证 明 人", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			List list = userpeixunservice.getAllByUserId(zhichengapply.getUser_id().toString());
			for (int i = 0; i < list.size(); i++) {
				userpeixun = (UserPeixun) list.get(i);

				String temp = userpeixun.getStart_date();
				if (temp != null) {
					String year = temp.substring(0, 4);
					String month = temp.substring(5, 7);
					temp = year + "年" + month + "月";
				}
				String temp2 = userpeixun.getEnd_date();
				if (temp2 != null) {
					String year = temp2.substring(0, 4);
					String month = temp2.substring(5, 7);
					temp2 = year + "年" + month + "月";
				}

				cell = new PdfPCell(new Paragraph(temp + "-" + temp2, f14));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.setMinimumHeight(30);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userpeixun.getContent(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userpeixun.getPlace(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userpeixun.getZhengmingren(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

			}
			cell = new PdfPCell();
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);

			document.add(table);
			document.newPage();

			// 第四页 添加工 作 经 历
			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("工  作  经  历"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(20);
			document.add(p);

			// 添加一个表格
			widths[0] = 30f;
			widths[1] = 25f;
			widths[2] = 30f;
			widths[3] = 15f;
			table = new PdfPTable(widths);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);
			cell = new PdfPCell(new Paragraph("起 止 时 间", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setMinimumHeight(30);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("单    位", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("从事何专业技术工作", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("职 务", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			list = userworkservice.getAllByUserId(zhichengapply.getUser_id().toString());
			for (int i = 0; i < list.size(); i++) {
				UserWork userwork = (UserWork) list.get(i);

				String temp = userwork.getStart_date();
				if (temp != null) {
					String year = temp.substring(0, 4);
					String month = temp.substring(5, 7);
					temp = year + "年" + month + "月";
				}
				String temp2 = userwork.getEnd_date();
				if (temp2 != null) {
					String year = temp2.substring(0, 4);
					String month = temp2.substring(5, 7);
					temp2 = year + "年" + month + "月";
				}
				if (userwork.getToNow() != null) {
					if (Integer.parseInt(userwork.getToNow()) == 1) {
						temp2 = "至今";
					}
				}

				cell = new PdfPCell(new Paragraph(temp + "-" + temp2, f14));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.setMinimumHeight(30);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userwork.getDepart(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userwork.getWork_content(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userwork.getZhiwei(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

			}
			cell = new PdfPCell();
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			document.add(table);
			document.newPage();

			// 第五页 添加专业技术工作业绩
			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("任现职前主要专业技术工作业绩登记"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(20);
			document.add(p);

			// 添加一个表格
			widths[0] = 30f;
			widths[1] = 35f;
			widths[2] = 15f;
			widths[3] = 20f;
			table = new PdfPTable(widths);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);
			cell = new PdfPCell(new Paragraph("起 止 时 间", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("专业技术工作名称（项目、课题、成果等）", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("工作内容、本人起何作用（主持、参加、独立）", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("完成情况及效果（获何奖励效益或专利）", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			list = userskillservice.getAllByUserId(zhichengapply.getUser_id().toString());
			for (int i = 0; i < list.size(); i++) {
				UserSkill userskill = (UserSkill) list.get(i);

				String temp = userskill.getStart_date();
				if (temp != null) {
					String year = temp.substring(0, 4);
					String month = temp.substring(5, 7);
					temp = year + "年" + month + "月";
				}
				String temp2 = userskill.getEnd_date();
				if (temp2 != null) {
					String year = temp2.substring(0, 4);
					String month = temp2.substring(5, 7);
					temp2 = year + "年" + month + "月";
				}

				cell = new PdfPCell(new Paragraph(temp + "-" + temp2, f14));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userskill.getProject_name(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userskill.getWork_content(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userskill.getProject_result(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

			}
			cell = new PdfPCell();
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			document.add(table);
			document.newPage();

			// 第五页 添加专业技术工作业绩 任现职后主要专业技术工作业绩登记（一）
			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("任现职后主要专业技术工作业绩登记"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(20);
			document.add(p);

			// 添加一个表格
			widths[0] = 30f;
			widths[1] = 30f;
			widths[2] = 20f;
			widths[3] = 20f;
			table = new PdfPTable(widths);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);
			cell = new PdfPCell(new Paragraph("起 止 时 间", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("专业技术工作名称（项目、课题、成果等）", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("工作内容、本人起何作用（主持、参加、独立）", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("完成情况及效果（获何奖励效益或专利）", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			list = userskill_2service.getAllByUserId(zhichengapply.getUser_id().toString());
			for (int i = 0; i < list.size(); i++) {
				UserSkill_2 userskill_2 = (UserSkill_2) list.get(i);

				String temp = userskill_2.getStart_date();
				if (temp != null) {
					String year = temp.substring(0, 4);
					String month = temp.substring(5, 7);
					temp = year + "年" + month + "月";
				}
				String temp2 = userskill_2.getEnd_date();
				if (temp2 != null) {
					String year = temp2.substring(0, 4);
					String month = temp2.substring(5, 7);
					temp2 = year + "年" + month + "月";
				}

				cell = new PdfPCell(new Paragraph(temp + "-" + temp2, f14));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userskill_2.getProject_name(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userskill_2.getWork_content(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userskill_2.getProject_result(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

			}
			cell = new PdfPCell();
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			document.add(table);
			document.newPage();

			// 第六页 著作、论文及重要技术报告登记
			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("著作、论文及重要技术报告登记"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(20);
			document.add(p);

			// 添加一个表格
			widths[0] = 15f;
			widths[1] = 50f;
			widths[2] = 20f;
			widths[3] = 15f;
			table = new PdfPTable(widths);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);
			cell = new PdfPCell(new Paragraph("日  期", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("名称及内容提要", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("出版、登载获奖或在学术会议上交流情况", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(" 合（独）著、译", fb16));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			list = userreportservice.getAllByUserId(zhichengapply.getUser_id().toString());
			for (int i = 0; i < list.size(); i++) {
				UserReport userreport = (UserReport) list.get(i);

				String temp = userreport.getDate();
				if (temp != null) {
					String year = temp.substring(0, 4);
					String month = temp.substring(5, 7);
					temp = year + "年" + month + "月";
				}
				cell = new PdfPCell(new Paragraph(temp, f14));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userreport.getName() + "\n\n" + userreport.getJieshao(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userreport.getContent(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userreport.getType(), f14));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

			}
			cell = new PdfPCell();
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			table.addCell(cell);
			document.add(table);
			document.newPage();

			// 第七页 考试成绩及答辩情况
			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("考试成绩及答辩情况"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(20);
			document.add(p);

			// 添加一个表格
			float[] widths5 = { 0.2f, 0.3f, 0.2f, 0.2f, 0.1f };
			widths5[0] = 15f;
			widths5[1] = 20f;
			widths5[2] = 20f;
			widths5[3] = 20f;
			widths5[4] = 25f;
			table = new PdfPTable(widths5);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);
			cell = new PdfPCell(new Paragraph("日  期", fb16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setMinimumHeight(30);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("考试种类", fb16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("考试科目", fb16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("考试成绩", fb16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("组织考试单位", fb16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			list = userexamservice.getAllByUserId(zhichengapply.getUser_id().toString());
			for (int i = 0; i < 6; i++) {
				UserExam userexam = new UserExam();
				if (list.size() > i) {
					userexam = (UserExam) list.get(i);
				} else {
					userexam.setExam_date(" ");
					userexam.setType(" ");
					userexam.setKemu(" ");
					userexam.setChengji(" ");
					userexam.setZuzhizhe(" ");
				}
				cell = new PdfPCell(new Paragraph(userexam.getExam_date(), f16));
				cell.setPadding(5f);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userexam.getType(), f16));
				cell.setPadding(5f);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userexam.getKemu(), f16));
				cell.setPadding(5f);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userexam.getChengji(), f16));
				cell.setPadding(5f);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userexam.getZuzhizhe(), f16));
				cell.setPadding(5f);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
			}

			cell = new PdfPCell(new Paragraph("答\n\n辩\n\n情\n\n况", f17));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph("                          公    章\n\n    负责人：             年  月  日\n\n\n", f17));
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.setColspan(4);
			table.addCell(cell);
			document.add(table);

			// 新一页 年度及任职期满考核结果
			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("年度及任职期满考核结果"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(20);
			document.add(p);

			// 添加一个表格
			float[] widths6 = { 0.5f, 0.5f };
			table = new PdfPTable(widths6);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);

			UserBusiness userbusiness = userbusinessservice.getByUserId(zhichengapply.getUser_id());

			cell = new PdfPCell(new Paragraph(userbusiness.getYijian_1(), f16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_TOP);
			cell.setMinimumHeight(300);
			cell.setColspan(2);
			cell.disableBorderSide(2);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph("\n\n\n    负责人:" + userbusiness.getFuzeren_1() + "\n\n\n", f17));
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.disableBorderSide(1);
			cell.disableBorderSide(8);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph("     公    章\n\n    年  月  日\n\n\n", f17));
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.disableBorderSide(1);
			cell.disableBorderSide(4);
			table.addCell(cell);
			document.add(table);

			// 新一页 单 位 推 荐 意 见
			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("单 位 推 荐 意 见"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(20);
			document.add(p);

			// 添加一个表格
			table = new PdfPTable(widths6);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);

			cell = new PdfPCell(new Paragraph("基 层 单 位 意 见", f16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_TOP);
			cell.setMinimumHeight(30);
			cell.setColspan(2);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph(userbusiness.getYijian_2(), f16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_TOP);
			cell.setMinimumHeight(180);
			cell.setColspan(2);
			cell.disableBorderSide(2);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph("\n\n\n    负责人:" + userbusiness.getFuzeren_2() + "\n\n\n", f17));
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.disableBorderSide(1);
			cell.disableBorderSide(8);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph("     公    章\n\n    年  月  日\n\n\n", f17));
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.disableBorderSide(1);
			cell.disableBorderSide(4);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph("呈 报 单 位 意 见", f16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_TOP);
			cell.setMinimumHeight(30);
			cell.setColspan(2);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph(userbusiness.getYijian_3(), f16));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_TOP);
			cell.setMinimumHeight(180);
			cell.setColspan(2);
			cell.disableBorderSide(2);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph("\n\n\n    负责人:" + userbusiness.getFuzeren_3() + "\n\n\n", f17));
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.disableBorderSide(1);
			cell.disableBorderSide(8);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph("     公    章\n\n    年  月  日\n\n\n", f17));
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.disableBorderSide(1);
			cell.disableBorderSide(4);
			table.addCell(cell);

			document.add(table);

			// 添加后续模板
			PdfReader reader4 = new PdfReader(templetPath + "\\doc05_2.pdf");
			int m = reader4.getNumberOfPages();
			PdfImportedPage page2;
			for (int i = 1; i <= m; i++) {
				page2 = writer.getImportedPage(reader4, i);
				Image image = Image.getInstance(page2);
				image.setAbsolutePosition(0, 0);
				document.add(image);
				document.newPage();
			}

			document.close();

		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();
		}
	}

	private void createDoc06(ZhichengApply zhichengapply) {
		String fileName = templetPath + "\\doc06.pdf"; //
		try {
			PdfReader reader = new PdfReader(fileName);
			ByteArrayOutputStream bos = new ByteArrayOutputStream();
			PdfStamper stamp = new PdfStamper(reader, bos);

			/**
			 * 使用中文字体 如果是利用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体就行了
			 */
			AcroFields form = stamp.getAcroFields();

			User user = userservice.getById(zhichengapply.getUser_id().toString());
			UserBaseInfor userbaseinfor = userbaseinforservice.getByUserId(zhichengapply.getUser_id().toString());
			// （第一页）
			form.setField("apply_rank", zhichengapply.getApply_rank());
			form.setField("name", user.getName());
			form.setField("gender", userbaseinfor.getGender());
			form.setField("birthday", userbaseinfor.getBirthday());
			form.setField("canjiashijian", userbaseinfor.getCanjiashijian());
			form.setField("congshizhuanye", userbaseinfor.getCongshizhuanye());
			form.setField("renzhizige", userbaseinfor.getRenzhizige());
			form.setField("shenpishijian", userbaseinfor.getShenpishijian());
			form.setField("shenpidanwei", userbaseinfor.getShenpidanwei());
			form.setField("xingzhengzhiwu", userbaseinfor.getXingzhengzhiwu());
			form.setField("yingyu", userbaseinfor.getYingyu());
			form.setField("jisuanji", userbaseinfor.getJisuanji());

			com.jfn.entity.Calendar calendar = calendarservice.getById("1");

			int Year = Integer.parseInt(calendar.getStart_date().substring(0, 4));
			int year05 = Year - 1;
			int year04 = Year - 2;
			int year03 = Year - 3;
			int year02 = Year - 4;
			int year01 = Year - 5;

			String kaohe05 = null;
			String kaohe04 = null;
			String kaohe03 = null;
			String kaohe02 = null;
			String kaohe01 = null;

			String str = userbaseinfor.getKaohe();
			String[] arr = null;
			if (str != null && str != "") {
				arr = str.split("\\|");
				for (int i = arr.length - 1; i >= 0; i--) {
					String tempYear = arr[i].substring(0, 4);
					if (Integer.parseInt(tempYear) == year05)
						kaohe05 = year05 + "年:" + arr[i].substring(6);
					if (Integer.parseInt(tempYear) == year04)
						kaohe04 = year04 + "年:" + arr[i].substring(6);
					if (Integer.parseInt(tempYear) == year03)
						kaohe03 = year03 + "年:" + arr[i].substring(6);
					if (Integer.parseInt(tempYear) == year02)
						kaohe02 = year02 + "年:" + arr[i].substring(6);
					if (Integer.parseInt(tempYear) == year01)
						kaohe01 = year01 + "年:" + arr[i].substring(6);
				}
				form.setField("kaoheYear01", kaohe01);
				form.setField("kaoheYear02", kaohe02);
				form.setField("kaoheYear03", kaohe03);
				form.setField("kaoheYear04", kaohe04);
				form.setField("kaoheYear05", kaohe05);
			}
			List list = userpeixunservice.getAllByUserId(zhichengapply.getUser_id().toString());
			String userstudyFieldString = "";
			if (list.size() > 0) {
				for (int i = 0; i < list.size(); i++) {
					UserPeixun userpeixun = (UserPeixun) list.get(i);
					if (userpeixun.getIsTop() != null && Integer.parseInt(userpeixun.getIsTop()) == 1) {
						form.setField("xueli", userpeixun.getXueli());
						form.setField("xuezhi", userpeixun.getXuezhi());
						form.setField("xuexiao", userpeixun.getPlace());
						form.setField("end_date", userpeixun.getEnd_date());
						form.setField("zhuanye", userpeixun.getContent());
					}
					userstudyFieldString += userpeixun.getStart_date() + "-" + userpeixun.getEnd_date() + "," + userpeixun.getPlace() + "," + userpeixun.getContent() + "," + userpeixun.getXueli()
							+ "\n";
				}
			}

			list = userworkservice.getAllByUserId(zhichengapply.getUser_id().toString());
			String userworkFieldString = "";
			if (list.size() > 0) {
				for (int i = 0; i < list.size(); i++) {
					UserWork userwork = (UserWork) list.get(i);
					String tempString3 = userwork.getEnd_date() == null ? "至今" : userwork.getEnd_date();
					userworkFieldString += userwork.getStart_date() + "-" + tempString3 + "," + userwork.getDepart() + "," + userwork.getWork_content() + "," + userwork.getZhiwei() + "\n";
				}
			}

			// 先出生成临时pdf
			stamp.setFormFlattening(true);
			reader.close();
			stamp.close();
			String tempPath = templetPath + "\\temp_06.pdf";
			FileOutputStream fos = new FileOutputStream(tempPath);
			fos.write(bos.toByteArray());
			bos.close();
			fos.close();
			// 重新读取PDF到document，继续添加后面页面
			Document document = new Document(PageSize.A3);
			PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(exportPath + "\\" + "4 任职资格综合情况表" + ".pdf"));

			document.open();
			PdfReader reader3 = new PdfReader(tempPath);
			int n = reader.getNumberOfPages();
			PdfImportedPage page;
			for (int i = 1; i <= 1; i++) {
				page = writer.getImportedPage(reader3, i);
				Image image = Image.getInstance(page);
				image.setAbsolutePosition(0, 0);
				document.add(image);
			}

			List listUserchengguo = userchengguoservice.getAllByUserId(zhichengapply.getUser_id().toString());
			if (listUserchengguo.size() >= 9) {
				ftemp = f10;
			} else {
				ftemp = f12;
			}

			// 添加一个表格
			float[] widths5_1 = { 0.05f, 0.95f };
			PdfPTable table = new PdfPTable(widths5_1);
			table.setWidthPercentage(100);
			table.setExtendLastRow(true);
			// 学习培训经历
			PdfPCell cell = new PdfPCell(new Paragraph("学习培训经历", f12));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userstudyFieldString, ftemp));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			// 专业技术工作简历

			cell = new PdfPCell(new Paragraph("专业技术工作简历", f12));
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userworkFieldString, ftemp));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			// 项目

			cell = new PdfPCell(new Paragraph("任现职以来承担的项目", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			float[] widths5_2 = { 0.5f, 0.1f, 0.2f, 0.1f, 0.1f };
			PdfPTable pdfptableTemp = new PdfPTable(widths5_2);
			pdfptableTemp.setWidthPercentage(100);

			cell = new PdfPCell(new Paragraph("项目名称(起止时间)", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(4);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("项目编号", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("项目来源", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("项目经费", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("承担任务", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(8);
			pdfptableTemp.addCell(cell);

			list = userprojectservice.getAllByUserId(zhichengapply.getUser_id().toString());
			for (int i = 0; i < list.size(); i++) {

				UserProject userproject = (UserProject) list.get(i);
				cell = new PdfPCell(new Paragraph(userproject.getProject_name() + "(" + userproject.getStart_date() + "-" + userproject.getEnd_date() + ")", ftemp));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(2);
				cell.disableBorderSide(4);
				pdfptableTemp.addCell(cell);

				cell = new PdfPCell(new Paragraph(userproject.getProject_result(), ftemp));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(2);
				pdfptableTemp.addCell(cell);

				cell = new PdfPCell(new Paragraph(userproject.getLaiyuan(), ftemp));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(2);
				pdfptableTemp.addCell(cell);

				cell = new PdfPCell(new Paragraph(userproject.getJine(), ftemp));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(2);
				pdfptableTemp.addCell(cell);

				cell = new PdfPCell(new Paragraph(userproject.getJiaose(), ftemp));
				cell.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(2);
				cell.disableBorderSide(8);
				pdfptableTemp.addCell(cell);

			}
			table.addCell(pdfptableTemp);

			// 任现职资格以来取得的主要成果
			cell = new PdfPCell(new Paragraph("任现职资格以来取得的主要成果", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			float[] widths5_3 = { 0.05f, 0.95f };
			PdfPTable nested5_3 = new PdfPTable(widths5_3);
			nested5_3.setWidthPercentage(100);

			cell = new PdfPCell(new Paragraph("重要贡献", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(4);
			// cell.setMinimumHeight(30);
			nested5_3.addCell(cell);
			UserBusiness userbusiness = userbusinessservice.getByUserId(zhichengapply.getUser_id());
			cell = new PdfPCell(new Paragraph(userbusiness.getChuangxin(), ftemp));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(8);
			nested5_3.addCell(cell);
			cell = new PdfPCell(new Paragraph("奖项", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(4);
			// cell.setMinimumHeight(30);
			nested5_3.addCell(cell);

			// 奖项

			list = userawardservice.getAllByUserId(zhichengapply.getUser_id().toString());
			if (list.size() != 0) {
				float[] widths5_4 = { 0.5f, 0.2f, 0.3f };
				pdfptableTemp = new PdfPTable(widths5_4);
				pdfptableTemp.setWidthPercentage(100);

				cell = new PdfPCell(new Paragraph("奖项名称", ftemp));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				cell.disableBorderSide(4);
				pdfptableTemp.addCell(cell);
				cell = new PdfPCell(new Paragraph("排名", ftemp));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				pdfptableTemp.addCell(cell);
				cell = new PdfPCell(new Paragraph("级别", ftemp));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				cell.disableBorderSide(8);
				pdfptableTemp.addCell(cell);

				for (int i = 0; i < list.size(); i++) {
					UserAward useraward = (UserAward) list.get(i);
					cell = new PdfPCell(new Paragraph(useraward.getName(), ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					cell.disableBorderSide(4);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(useraward.getJiaose(), ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(useraward.getType(), ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					cell.disableBorderSide(8);
					pdfptableTemp.addCell(cell);

				}
				nested5_3.addCell(pdfptableTemp);
			} else {
				cell = new PdfPCell(new Paragraph(" ", f12));
				// cell.setPadding(5f);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				cell.disableBorderSide(2);
				cell.disableBorderSide(4);
				cell.disableBorderSide(8);
				nested5_3.addCell(cell);
			}

			cell = new PdfPCell(new Paragraph("论文专著", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(4);
			nested5_3.addCell(cell);

			// 论文专著
			float[] widths5_5 = { 0.455f, 0.2f, 0.1f, 0.1f, 0.095f, 0.05f };

			if (listUserchengguo.size() > 6) {
				ftemp = f10;
				widths5_5[0] = 0.5f;
				widths5_5[1] = 0.18f;
				widths5_5[2] = 0.085f;
				widths5_5[3] = 0.085f;
				widths5_5[4] = 0.08f;
				widths5_5[5] = 0.07f;
			}

			pdfptableTemp = new PdfPTable(widths5_5);
			pdfptableTemp.setWidthPercentage(100);

			cell = new PdfPCell(new Paragraph("题目", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(4);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("刊物、年份、卷期、页码", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("日期", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("排名", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("级别", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			pdfptableTemp.addCell(cell);
			cell = new PdfPCell(new Paragraph("影响因子", ftemp));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(8);
			pdfptableTemp.addCell(cell);

			if (listUserchengguo.size() != 0) {
				for (int i = 0; i < listUserchengguo.size(); i++) {

					UserChengguo userchengguo = (UserChengguo) listUserchengguo.get(i);
					cell = new PdfPCell(new Paragraph(userchengguo.getCg_name(), ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					cell.disableBorderSide(4);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(userchengguo.getCg_jieshao(), ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					String temp = userchengguo.getCg_date();
					if (temp != null) {
						String year = temp.substring(0, 4);
						String month = temp.substring(5, 7);
						temp = year + "年" + month + "月";
					}
					cell = new PdfPCell(new Paragraph(temp, ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(userchengguo.getJiaose(), ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(userchengguo.getType(), ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(userchengguo.getYingxiangyinzi(), ftemp));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					cell.disableBorderSide(8);
					pdfptableTemp.addCell(cell);

				}
			} else {
				for (int i = 0; i < 2; i++) {
					cell = new PdfPCell(new Paragraph("", f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					cell.disableBorderSide(4);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph("", f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph("", f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph("", f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph("", f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph("", f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					cell.disableBorderSide(8);
					pdfptableTemp.addCell(cell);
				}
			}
			nested5_3.addCell(pdfptableTemp);

			cell = new PdfPCell(new Paragraph("专利", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(2);
			cell.disableBorderSide(4);
			// cell.setMinimumHeight(30);
			nested5_3.addCell(cell);

			// 专利
			list = userzhuanliservice.getAllByUserId(zhichengapply.getUser_id().toString());
			if (list.size() != 0) {
				float[] widths5_6 = { 0.3f, 0.2f, 0.2f, 0.3f };
				pdfptableTemp = new PdfPTable(widths5_6);
				pdfptableTemp.setWidthPercentage(100);

				cell = new PdfPCell(new Paragraph("专利名称", f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				cell.disableBorderSide(4);
				pdfptableTemp.addCell(cell);
				cell = new PdfPCell(new Paragraph("专利数量", f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				pdfptableTemp.addCell(cell);
				cell = new PdfPCell(new Paragraph("排名", f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				pdfptableTemp.addCell(cell);
				cell = new PdfPCell(new Paragraph("级别", f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				cell.disableBorderSide(8);
				pdfptableTemp.addCell(cell);

				for (int i = 0; i < list.size(); i++) {
					UserZhuanli userzhuanli = (UserZhuanli) list.get(i);
					cell = new PdfPCell(new Paragraph(userzhuanli.getName(), f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					cell.disableBorderSide(4);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(userzhuanli.getOther(), f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(userzhuanli.getJiaose(), f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					pdfptableTemp.addCell(cell);

					cell = new PdfPCell(new Paragraph(userzhuanli.getType(), f12));
					cell.setHorizontalAlignment(Element.ALIGN_LEFT);
					cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
					cell.disableBorderSide(2);
					cell.disableBorderSide(8);
					pdfptableTemp.addCell(cell);

				}
				nested5_3.addCell(pdfptableTemp);
			} else {
				cell = new PdfPCell(new Paragraph(" ", f12));
				// cell.setPadding(5f);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.disableBorderSide(1);
				cell.disableBorderSide(2);
				cell.disableBorderSide(4);
				cell.disableBorderSide(8);
				nested5_3.addCell(cell);
			}

			table.addCell(nested5_3);

			// 符合职称申报条件中的
			cell = new PdfPCell(new Paragraph("符合条件", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			// cell.setMinimumHeight(30);
			table.addCell(cell);

			float[] widths5_9 = { 0.27f, 0.27f, 0.23f, 0.23f };
			PdfPTable nested5_9 = new PdfPTable(widths5_9);
			nested5_9.setWidthPercentage(100);

			String tiaojian1 = "";
			String tiaojian2 = "";
			String tiaojian3 = "";
			String tiaojian4 = "";
			str = userbaseinfor.getTiaojian();
			arr = null;
			if (str != null && str != "") {
				arr = str.split("\\|");
				tiaojian1 = arr[0].substring(2);
				tiaojian2 = arr[1].substring(2);
				tiaojian3 = arr[2].substring(2);
				tiaojian4 = arr[3].substring(2);

			}
			if (tiaojian1.equals("1")) {
				cell = new PdfPCell(new Paragraph("1[是]", f12));
			} else {
				cell = new PdfPCell(new Paragraph("1[否]", f12));
			}
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(2);
			cell.disableBorderSide(4);
			nested5_9.addCell(cell);

			if (tiaojian2.equals("1")) {
				cell = new PdfPCell(new Paragraph("2[是]", f12));
			} else {
				cell = new PdfPCell(new Paragraph("2[否]", f12));
			}
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(2);
			nested5_9.addCell(cell);

			if (tiaojian3.equals("1")) {
				cell = new PdfPCell(new Paragraph("3[是]", f12));
			} else {
				cell = new PdfPCell(new Paragraph("3[否]", f12));
			}
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(2);
			nested5_9.addCell(cell);

			if (tiaojian4.equals("1")) {
				cell = new PdfPCell(new Paragraph("4(①)", f12));
			} else if (tiaojian4.equals("2")) {
				cell = new PdfPCell(new Paragraph("4(②)", f12));
			} else if (tiaojian4.equals("3")) {
				cell = new PdfPCell(new Paragraph("4(③)", f12));
			} else {
				cell = new PdfPCell(new Paragraph("4(④)", f12));
			}
			cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(2);
			cell.disableBorderSide(8);
			nested5_9.addCell(cell);

			table.addCell(nested5_9);

			// 单位呈报意见
			cell = new PdfPCell(new Paragraph("单位呈报意见", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			float[] widths5_7 = { 0.54f, 0.09f, 0.37f };
			PdfPTable nested5_7 = new PdfPTable(widths5_7);
			nested5_7.setWidthPercentage(100);

			float[] widths5_8 = { 0.5f, 0.5f };
			PdfPTable nested5_8 = new PdfPTable(widths5_8);
			nested5_8.setWidthPercentage(100);

			cell = new PdfPCell(new Paragraph("是否破格", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(4);
			nested5_8.addCell(cell);

			cell = new PdfPCell(new Paragraph(zhichengapply.getApply_isbreak(), f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(8);
			nested5_8.addCell(cell);

			cell = new PdfPCell(new Paragraph("\n\n                                 人事（职改）部门签章", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.disableBorderSide(2);
			cell.disableBorderSide(4);
			cell.disableBorderSide(8);
			cell.setColspan(2);
			nested5_8.addCell(cell);

			nested5_7.addCell(nested5_8);

			cell = new PdfPCell(new Paragraph("单位审核意见", f12));
			cell.setPadding(15f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.disableBorderSide(1);
			cell.disableBorderSide(2);
			nested5_7.addCell(cell);

			cell = new PdfPCell(new Paragraph("                单位签章\n", f12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
			cell.disableBorderSide(1);
			cell.disableBorderSide(2);
			cell.disableBorderSide(8);
			nested5_7.addCell(cell);

			table.addCell(nested5_7);

			// 不得改变表格格式，用 A3 纸打印
			cell = new PdfPCell(new Paragraph("(不得改变表格格式，用 A3  纸打印)", fb12));
			// cell.setPadding(5f);
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setColspan(2);
			cell.disableBorderSide(1);
			cell.disableBorderSide(2);
			cell.disableBorderSide(4);
			cell.disableBorderSide(8);
			table.addCell(cell);

			table.setTotalWidth((float) ((28 - 1.72) * 28.3527));
			table.setLockedWidth(true);
			table.writeSelectedRows(0, -1, (float) (1.71 * 28.3527), (float) ((42 - 7.07) * 28.3527), writer.getDirectContent());

			document.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();
		}
	}

	public void createDoc07(ZhichengApply zhichengapply) {

		try {
			Document document = new Document(PageSize.A3.rotate());
			Calendar cal = Calendar.getInstance();
			int apply_Year = cal.get(Calendar.YEAR);
			int apply_Month = cal.get(Calendar.MONTH) + 1;
			int apply_Day = cal.get(Calendar.DATE);

			// String apply_date = zhichengapply.getApply_date();
			// String = apply_date.substring(0, 4);
			// String apply_Month = apply_date.substring(5, 7);
			// String apply_Day = apply_date.substring(8, 10);

			PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(exportPath + "\\5 任职资格人员情况一览表" + ".pdf"));

			document.open();

			Paragraph p = new Paragraph();

			p = new Paragraph();
			p.setFont(f16);
			p.setAlignment(Element.ALIGN_LEFT);
			p.add(new Chunk("附件5"));
			document.add(p);

			p = new Paragraph();
			p.setFont(fb18);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("申报 ( " + zhichengapply.getApply_rank() + ") 级专业技术职务任职资格人员情况一览表"));
			p.setSpacingBefore(10);
			p.setSpacingAfter(10);
			document.add(p);

			p = new Paragraph();
			p.setFont(f14);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("单  位（盖章）:                                        填报人:                 联系电话:                  填报时间: " + apply_Year + "年" + apply_Month + "月" + apply_Day + " 日 "));
			p.setSpacingBefore(10);
			p.setSpacingAfter(10);
			document.add(p);

			// 添加一个表格
			float[] widths = { 0.025f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.15f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.075f, 0.05f };
			PdfPTable table = new PdfPTable(widths);
			table.setWidthPercentage(100);
			PdfPCell cell;
			cell = new PdfPCell(new Paragraph("序号", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("姓名", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("性别", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("出生年月", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("参加工作时间", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("现从事专业", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("专业年限", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			PdfPTable nested1 = new PdfPTable(1);
			nested1.setWidthPercentage(100);
			cell = new PdfPCell(new Paragraph("现专业技术资格", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.BOTTOM);
			nested1.addCell(cell);

			PdfPTable nested2 = new PdfPTable(4);
			nested2.setWidthPercentage(100);
			cell = new PdfPCell(new Paragraph("资格名称", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested2.addCell(cell);
			cell = new PdfPCell(new Paragraph("获得资格时间", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested2.addCell(cell);
			cell = new PdfPCell(new Paragraph("任职年限", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested2.addCell(cell);
			cell = new PdfPCell(new Paragraph("终审单位", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.NO_BORDER);
			nested2.addCell(cell);

			nested1.addCell(nested2);
			table.addCell(nested1);

			cell = new PdfPCell(new Paragraph("学历", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("学位", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("毕业学校", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("所学专业", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("毕业时间", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("外语成绩", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("计算机成绩", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("申请资格名称", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("申报专业", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("是否破格", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			User user = userservice.getById(zhichengapply.getUser_id().toString());
			UserBaseInfor userbaseinfor = userbaseinforservice.getByUserId(user.getId().toString());
			UserPeixun userpeixun = userpeixunservice.getByUserId(user.getId().toString());

			cell = new PdfPCell(new Paragraph("1", f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(user.getName(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userbaseinfor.getGender(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userbaseinfor.getBirthday(), f10));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userbaseinfor.getCanjiashijian(), f10));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userbaseinfor.getCongshizhuanye(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			if (userbaseinfor.getCanjiashijian() != null && userbaseinfor.getCanjiashijian() != "") {
				String zhuanyeYear = userbaseinfor.getCanjiashijian().substring(0, 4);
				int zhuanyeYearInt = apply_Year - Integer.parseInt(zhuanyeYear);

				cell = new PdfPCell(new Paragraph(zhuanyeYearInt + "年", f12));
			} else {
				cell = new PdfPCell(new Paragraph("", f12));

			}
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			PdfPTable nested21 = new PdfPTable(4);
			nested21.setWidthPercentage(100);
			cell = new PdfPCell(new Paragraph(userbaseinfor.getRenzhizige(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested21.addCell(cell);
			cell = new PdfPCell(new Paragraph(userbaseinfor.getShenpishijian(), f10));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested21.addCell(cell);

			if (userbaseinfor.getShenpishijian() != null && userbaseinfor.getShenpishijian() != "") {
				String renzhiYear = userbaseinfor.getShenpishijian().substring(0, 4);
				int renzhiYearInt = apply_Year - Integer.parseInt(renzhiYear);

				cell = new PdfPCell(new Paragraph(renzhiYearInt + "年", f12));
			} else {
				cell = new PdfPCell(new Paragraph("", f12));
			}
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested21.addCell(cell);
			cell = new PdfPCell(new Paragraph(userbaseinfor.getShenpidanwei(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.NO_BORDER);
			nested21.addCell(cell);

			table.addCell(nested21);

			cell = new PdfPCell(new Paragraph(userpeixun.getXueli(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userpeixun.getXuewei(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userpeixun.getPlace(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userpeixun.getContent(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userpeixun.getEnd_date(), f10));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			cell = new PdfPCell(new Paragraph(userbaseinfor.getYingyu(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(userbaseinfor.getJisuanji(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("自然科学系列", f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(zhichengapply.getApply_type(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph(zhichengapply.getApply_isbreak(), f12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			document.add(table);
			document.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();

		}
	}

	public String createDoc07_hr(String startDate, String endDate, String body_id, ZhichengApply zhichengapply, String apply_userRank, String apply_body, String apply_userName,
			String apply_userMobile, String apply_date) {

		try {
			Document document = new Document(PageSize.A3.rotate());
			Calendar cal = Calendar.getInstance();
			int Year = cal.get(Calendar.YEAR);
			String doc07Path = getExportFilePath();
			// 如果没有输出路径，创建
			File dir = new File(doc07Path);
			if (!dir.exists()) {
				if (!dir.mkdir()) {
					log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
				}
			}
			doc07Path = doc07Path + "\\" + Year + "\\";
			// 如果没有输出路径，创建
			dir = new File(doc07Path);
			if (!dir.exists()) {
				if (!dir.mkdir()) {
					log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
				}
			}
			doc07Path = doc07Path + "body\\";
			// 如果没有输出路径，创建
			dir = new File(doc07Path);
			if (!dir.exists()) {
				if (!dir.mkdir()) {
					log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
				}
			}
			doc07Path = doc07Path + body_id + "\\";
			// 如果没有输出路径，创建
			dir = new File(doc07Path);
			if (!dir.exists()) {
				if (!dir.mkdir()) {
					log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
				}
			}
			PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(doc07Path + "\\5 任职资格人员情况一览表" + ".pdf"));

			document.open();

			Paragraph p = new Paragraph();

			p = new Paragraph();
			p.setFont(f16);
			p.setAlignment(Element.ALIGN_LEFT);
			p.add(new Chunk("附件5"));
			document.add(p);

			Paragraph p1 = new Paragraph();
			p1.setFont(fb18);
			p1.setAlignment(Element.ALIGN_CENTER);
			p1.add(new Chunk("申报 ( " + apply_userRank + " ) 级专业技术职务任职资格人员情况一览表"));
			p1.setSpacingBefore(10);
			p1.setSpacingAfter(10);
			document.add(p1);

			p = new Paragraph();
			p.setFont(f14);
			p.setAlignment(Element.ALIGN_CENTER);
			p.add(new Chunk("单  位（盖章）:" + apply_body + "     填报人:" + apply_userName + "     联系电话:" + apply_userMobile + "     填报时间:" + apply_date + " "));
			p.setSpacingBefore(10);
			p.setSpacingAfter(10);
			document.add(p);

			// 添加一个表格
			float[] widths = { 0.025f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.15f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.05f, 0.075f, 0.05f };
			PdfPTable table = new PdfPTable(widths);
			table.setWidthPercentage(100);
			PdfPCell cell;
			cell = new PdfPCell(new Paragraph("序号", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("姓名", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("性别", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("出生年月", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("参加工作时间", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("现从事专业", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("专业年限", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			PdfPTable nested1 = new PdfPTable(1);
			nested1.setWidthPercentage(100);
			cell = new PdfPCell(new Paragraph("现专业技术资格", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.BOTTOM);
			nested1.addCell(cell);

			PdfPTable nested2 = new PdfPTable(4);
			nested2.setWidthPercentage(100);
			cell = new PdfPCell(new Paragraph("资格名称", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested2.addCell(cell);
			cell = new PdfPCell(new Paragraph("获得资格时间", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested2.addCell(cell);
			cell = new PdfPCell(new Paragraph("任职年限", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.RIGHT);
			nested2.addCell(cell);
			cell = new PdfPCell(new Paragraph("终审单位", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			cell.setBorder(Rectangle.NO_BORDER);
			nested2.addCell(cell);

			nested1.addCell(nested2);
			table.addCell(nested1);

			cell = new PdfPCell(new Paragraph("学历", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("学位", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("毕业学校", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("所学专业", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("毕业时间", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("外语成绩", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("计算机成绩", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("申请资格名称", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("申报专业", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);
			cell = new PdfPCell(new Paragraph("是否破格", fb12));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
			table.addCell(cell);

			ArrayList<User> userListNew = new ArrayList<User>();
			ArrayList<ZhichengApply> zhichengApplylistNew = new ArrayList<ZhichengApply>();
			List<User> userList = null;
			if (body_id != null) {
				if (body_id.equals("1")) {
					userList = userservice.getAll();// 数据库中获取源数据
				} else {
					userList = userservice.getAllByBodyId(body_id);// 数据库中获取源数据
				}
				if (userList.size() != 0) {
					for (User user : userList) {
						List<ZhichengApply> zhichengApplylist = zhichengapplyservice.getUserByUserIdAndDate(user.getId(), startDate, endDate);
						if (zhichengApplylist.size() != 0) {
							if (zhichengapply.getApply_name().equals("-1") || zhichengApplylist.get(0).getApply_name().equals(zhichengapply.getApply_name())) {
								if (zhichengapply.getApply_type().equals("-1") || zhichengApplylist.get(0).getApply_type().equals(zhichengapply.getApply_type())) {
									if ((zhichengApplylist.get(0)).getStatus().equals(zhichengapply.getStatus())) {
										userListNew.add(user);
										zhichengApplylistNew.add(zhichengApplylist.get(0));
									}
								}
							}
						}
					}
				}

			}

			for (int i = 0; i < userListNew.size(); i++) {
				User user = (User) userListNew.get(i);
				UserBaseInfor userbaseinfor = userbaseinforservice.getByUserId(user.getId().toString());
				UserPeixun userpeixun = userpeixunservice.getByUserId(user.getId().toString());

				int numString = i + 1;
				cell = new PdfPCell(new Paragraph(numString + "", f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(user.getName(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userbaseinfor.getGender(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userbaseinfor.getBirthday(), f10));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userbaseinfor.getCanjiashijian(), f10));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userbaseinfor.getCongshizhuanye(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				if (userbaseinfor.getCanjiashijian() != null && userbaseinfor.getCanjiashijian() != "") {
					String zhuanyeYear = userbaseinfor.getCanjiashijian().substring(0, 4);
					int zhuanyeYearInt = Year - Integer.parseInt(zhuanyeYear);

					cell = new PdfPCell(new Paragraph(zhuanyeYearInt + "年", f12));
				} else {
					cell = new PdfPCell(new Paragraph("", f12));
				}
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				PdfPTable nested21 = new PdfPTable(4);
				nested21.setWidthPercentage(100);
				cell = new PdfPCell(new Paragraph(userbaseinfor.getRenzhizige(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.setBorder(Rectangle.RIGHT);
				nested21.addCell(cell);
				cell = new PdfPCell(new Paragraph(userbaseinfor.getShenpishijian(), f10));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.setBorder(Rectangle.RIGHT);
				nested21.addCell(cell);

				if (userbaseinfor.getShenpishijian() != null && userbaseinfor.getShenpishijian() != "") {
					String renzhiYear = userbaseinfor.getShenpishijian().substring(0, 4);
					int renzhiYearInt = Year - Integer.parseInt(renzhiYear);

					cell = new PdfPCell(new Paragraph(renzhiYearInt + "年", f12));
				} else {
					cell = new PdfPCell(new Paragraph("", f12));
				}
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.setBorder(Rectangle.RIGHT);
				nested21.addCell(cell);
				cell = new PdfPCell(new Paragraph(userbaseinfor.getShenpidanwei(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				cell.setBorder(Rectangle.NO_BORDER);
				nested21.addCell(cell);

				table.addCell(nested21);

				cell = new PdfPCell(new Paragraph(userpeixun.getXueli(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userpeixun.getXuewei(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userpeixun.getPlace(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userpeixun.getContent(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userpeixun.getEnd_date(), f10));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

				cell = new PdfPCell(new Paragraph(userbaseinfor.getYingyu(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(userbaseinfor.getJisuanji(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph("自然科学系列", f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(zhichengApplylistNew.get(i).getApply_type(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);
				cell = new PdfPCell(new Paragraph(zhichengApplylistNew.get(i).getApply_isbreak(), f12));
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
				table.addCell(cell);

			}

			document.add(table);
			document.close();

			return Year + "/body/" + body_id + "/5 任职资格人员情况一览表.pdf";
		} catch (FileNotFoundException e) {
			e.printStackTrace();
			return "";
		} catch (Exception e) {
			e.printStackTrace();
			return "";
		} finally {
			// doc.close();

		}
	}

	private void createDoc08(ZhichengApply zhichengapply) {
		String fileName = templetPath + "\\doc08.pdf"; //
		try {
			PdfReader reader = new PdfReader(fileName);
			ByteArrayOutputStream bos = new ByteArrayOutputStream();
			PdfStamper stamp = new PdfStamper(reader, bos);

			/**
			 * 使用中文字体 如果是利用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体就行了
			 */
			AcroFields form = stamp.getAcroFields();

			User user = userservice.getById(zhichengapply.getUser_id().toString());
			Body body = bodyservice.getById(user.getBody_id());
			UserBaseInfor userbaseinfor = userbaseinforservice.getByUserId(zhichengapply.getUser_id().toString());
			ZhichengDoc08 zhichengdoc08 = zhichengdoc08service.getByUserId(zhichengapply.getUser_id());
			// （第一页）
			form.setField("body_name", body.getName());
			form.setField("user_name", user.getName());
			form.setField("current_zhicheng", userbaseinfor.getCurrent_zhicheng());
			form.setField("apply_name", zhichengapply.getApply_name());
			form.setField("tuijian_name", zhichengdoc08.getTuijian_name());
			form.setField("tuijian_zhiwu", zhichengdoc08.getTuijian_zhiwu());
			form.setField("tuijian_danwei", zhichengdoc08.getTuijian_danwei());
			form.setField("tuijian_liyou", zhichengdoc08.getTuijian_liyou());
			form.setField("tuijian_zhuanjia", zhichengdoc08.getTuijian_zhuanjia());
			String xuelitestString = zhichengdoc08.getXueli() == null ? "" : zhichengdoc08.getXueli();
			String xueweitestString = zhichengdoc08.getXuewei() == null ? "" : zhichengdoc08.getXuewei();
			form.setField("xueli", xuelitestString + " / " + xueweitestString);

			// （第二页）
			form.setField("body_name_2", body.getName());
			form.setField("user_name_2", user.getName());
			form.setField("current_zhicheng_2", userbaseinfor.getCurrent_zhicheng());
			form.setField("apply_name_2", zhichengapply.getApply_name());
			form.setField("tuijian_name_2", zhichengdoc08.getTuijian_name_2());
			form.setField("tuijian_zhiwu_2", zhichengdoc08.getTuijian_zhiwu_2());
			form.setField("tuijian_danwei_2", zhichengdoc08.getTuijian_danwei_2());
			form.setField("tuijian_liyou_2", zhichengdoc08.getTuijian_liyou_2());
			form.setField("tuijian_zhuanjia_2", zhichengdoc08.getTuijian_zhuanjia_2());
			String xuelitestString_2 = zhichengdoc08.getXueli() == null ? "" : zhichengdoc08.getXueli();
			String xueweitestString_2 = zhichengdoc08.getXuewei() == null ? "" : zhichengdoc08.getXuewei();
			form.setField("xueli_2", xuelitestString_2 + " / " + xueweitestString_2);

			stamp.setFormFlattening(true);
			reader.close();
			stamp.close();
			String tempPath = exportPath + "\\6 破格申报专家推荐表.pdf";
			FileOutputStream fos = new FileOutputStream(tempPath);
			fos.write(bos.toByteArray());
			bos.close();
			fos.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();
		}
	}

	private void createDoc09(ZhichengApply zhichengapply) {
		String fileName = templetPath + "\\doc09.pdf"; //
		try {
			PdfReader reader = new PdfReader(fileName);
			ByteArrayOutputStream bos = new ByteArrayOutputStream();
			PdfStamper stamp = new PdfStamper(reader, bos);

			/**
			 * 使用中文字体 如果是利用 AcroFields填充值的不需要在程序中设置字体，在模板文件中设置字体为中文字体就行了
			 */
			AcroFields form = stamp.getAcroFields();

			User user = userservice.getById(zhichengapply.getUser_id().toString());
			Body body = bodyservice.getById(user.getBody_id());
			// （第一页）
			form.setField("body_name", body.getName());
			form.setField("user_name", user.getName());
			form.setField("apply_name", zhichengapply.getApply_name());

			UserBusiness userbusiness = userbusinessservice.getByUserId(user.getId());
			String str = userbusiness.getFengpi();
			String[] arr = null;
			if (str != null && str != "") {
				arr = str.split("\\|");
				for (int i = 0; i < arr.length; i++) {
					String temgString = "ft0" + (i + 1);
					form.setField(temgString, arr[i]);
				}
			}

			stamp.setFormFlattening(true);
			reader.close();
			stamp.close();
			String tempPath = exportPath + "\\7 报送材料明细.pdf";
			FileOutputStream fos = new FileOutputStream(tempPath);
			fos.write(bos.toByteArray());
			bos.close();
			fos.close();
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// doc.close();
		}
	}

	public String downLoadFile(int uploader_id, int file_type) throws Exception {
		Calendar cal = Calendar.getInstance();
		int Year = cal.get(Calendar.YEAR);
		SimpleDateFormat ft = null;
		Date date = null;
		Calendar cl = Calendar.getInstance();
		cl.setTime(new java.util.Date());
		date = cl.getTime();
		ft = new SimpleDateFormat("yyyyMMddHHmmss");
		String dateTime = ft.format(date);

		String downLoadFilePath = getExportFilePath();
		// 如果没有输出路径，创建
		File dir = new File(downLoadFilePath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}
		downLoadFilePath = downLoadFilePath + "\\" + Year + "\\";
		// 如果没有输出路径，创建
		dir = new File(downLoadFilePath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}
		downLoadFilePath = downLoadFilePath + "downLoadFile\\";
		// 如果没有输出路径，创建
		dir = new File(downLoadFilePath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}
		downLoadFilePath = downLoadFilePath + uploader_id + "\\";
		// 如果没有输出路径，创建
		dir = new File(downLoadFilePath);
		if (!dir.exists()) {
			if (!dir.mkdir()) {
				log.error("Failed to create a dir for uploading files.\nPlease check the upload directory of the server.( About line 45 of applicationContext.xml)");
			}
		}

		List<Attachfile> list = fileservice.getFilesByUploaderAndType(uploader_id, file_type);

		byte[] buffer = new byte[1024];
		// 生成的ZIP文件名为Demo.zip
		String strZipName = downLoadFilePath + "\\" + dateTime + ".zip";
		ZipOutputStream out = new ZipOutputStream(new FileOutputStream(strZipName));
		// 需要同时下载的两个文件result.txt ，source.txt

		for (int i = 0; i < list.size(); i++) {
			File srcFile = new File(list.get(i).getFile_path());
			FileInputStream fis = new FileInputStream(srcFile);
			out.putNextEntry(new ZipEntry(list.get(i).getFile_name()));
			int len;
			// 读入需要下载的文件的内容，打包到zip文件
			while ((len = fis.read(buffer)) > 0) {
				out.write(buffer, 0, len);
			}
			out.closeEntry();
			fis.close();
		}
		out.close();
		// System.out.println("生成Demo.zip成功");
		return Year + "/downLoadFile/" + uploader_id + "/" + dateTime + ".zip";
	}
}
